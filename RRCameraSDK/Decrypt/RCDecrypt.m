//
//  RCDecrypt.m
//  RRCameraSDK
//
//  Created by 淮静 on 15/5/26.
//  Copyright (c) 2015年 renn. All rights reserved.
//

#import "RCDecrypt.h"

@implementation RCDecrypt

int newmap[256] = {
    224,204,108,77,32,8,67,201,26,7,183,52,223,161,22,251,159,40,
    214,184,126,79,153,82,211,76,62,16,23,225,206,125,46,78,130,180,
    234,107,35,68,1,216,93,145,109,137,210,175,245,151,243,162,239,27,
    128,146,30,249,94,156,226,41,185,179,133,246,33,20,187,222,215,127,
    49,203,235,84,176,170,142,202,48,113,138,85,196,55,152,250,167,100,
    212,186,208,106,47,171,44,24,237,143,57,72,119,254,29,217,168,169,121,
    199,90,236,219,69,172,117,148,181,73,42,101,124,189,91,102,188,64,150,
    37,135,157,134,228,195,190,98,122,193,248,182,238,112,17,88,75,5,116,31,
    227,207,149,13,71,154,70,209,95,74,92,21,140,96,232,120,97,99,132,39,205,
    3,131,194,54,66,50,25,252,87,83,163,60,230,253,12,164,38,197,45,19,115,86,
    111,200,36,220,114,174,221,192,247,160,89,9,0,14,255,233,218,80,61,123,144,
    110,81,213,34,56,53,11,241,6,4,198,51,65,244,129,166,191,173,136,63,165,43,
    58,178,240,118,177,59,158,18,28,10,231,15,229,139,141,147,105,242,2,155,104,
    103
};

+(NSData *)dealDecrypt:(NSURL *)path
{
    NSData *data = [NSData dataWithContentsOfURL:path];
    const char *bytes = [data bytes];
    unsigned char *resultBytes = malloc(sizeof(unsigned char) *[data length]);
    for (int i = 0; i < [data length]; i++) {
        resultBytes[i] = newmap[(unsigned char)bytes[i]];
    }
    
    NSData *result = [NSData dataWithBytes:resultBytes length:[data length]];
    free(resultBytes);
//    NSLog(@"result:%@", result);
    
    return result;
}

@end
